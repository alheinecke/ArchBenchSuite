/******************************************************************************
** Copyright (c) 2013-2018, Alexander Heinecke                               **
** All rights reserved.                                                      **
**                                                                           **
** Redistribution and use in source and binary forms, with or without        **
** modification, are permitted provided that the following conditions        **
** are met:                                                                  **
** 1. Redistributions of source code must retain the above copyright         **
**    notice, this list of conditions and the following disclaimer.          **
** 2. Redistributions in binary form must reproduce the above copyright      **
**    notice, this list of conditions and the following disclaimer in the    **
**    documentation and/or other materials provided with the distribution.   **
** 3. Neither the name of the copyright holder nor the names of its          **
**    contributors may be used to endorse or promote products derived        **
**    from this software without specific prior written permission.          **
**                                                                           **
** THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS       **
** "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT         **
** LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR     **
** A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT      **
** HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,    **
** SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED  **
** TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR    **
** PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF    **
** LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING      **
** NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS        **
** SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.              **
******************************************************************************/

size_t g_reps_float_power8 = 100000000;

void gflops_float_qfma(double* data) {
  std::cout << "QFMA is not available on this architecture" << std::endl;
}

void gflops_float_fma(float* data) {
    __asm__ __volatile__("lxvw4x 63, 0, %0\n\t"
                         "lxvw4x 62, 0, %0\n\t"
                         "lxvw4x 61, 0, %0\n\t"
                         "lxvw4x 60, 0, %0\n\t"
                         "lxvw4x 59, 0, %0\n\t"
                         "lxvw4x 58, 0, %0\n\t"
                         "lxvw4x 57, 0, %0\n\t"
                         "lxvw4x 56, 0, %0\n\t"
                         "lxvw4x 55, 0, %0\n\t"
                         "lxvw4x 54, 0, %0\n\t"
                         "lxvw4x 53, 0, %0\n\t"
                         "lxvw4x 52, 0, %0\n\t"
                         "lxvw4x 51, 0, %0\n\t"
                         "lxvw4x 50, 0, %0\n\t"
                         "lxvw4x 49, 0, %0\n\t"
                         "lxvw4x 48, 0, %0\n\t"
                         "lxvw4x 47, 0, %0\n\t"
                         "lxvw4x 46, 0, %0\n\t"
                         "lxvw4x 45, 0, %0\n\t"
                         "lxvw4x 44, 0, %0\n\t"
                         "lxvw4x 43, 0, %0\n\t"
                         "lxvw4x 42, 0, %0\n\t"
                         "lxvw4x 41, 0, %0\n\t"
                         "lxvw4x 40, 0, %0\n\t"
                         "lxvw4x 39, 0, %0\n\t"
                         "lxvw4x 38, 0, %0\n\t"
                         "lxvw4x 37, 0, %0\n\t"
                         "lxvw4x 36, 0, %0\n\t"
                         "lxvw4x 35, 0, %0\n\t"
                         "lxvw4x 34, 0, %0\n\t"
                         "lxvw4x 33, 0, %0\n\t"
                         "lxvw4x 32, 0, %0\n\t"
                         "lxvw4x 31, 0, %0\n\t"
                         "lxvw4x 30, 0, %0\n\t"
                         "lxvw4x 29, 0, %0\n\t"
                         "lxvw4x 28, 0, %0\n\t"
                         "lxvw4x 27, 0, %0\n\t"
                         "lxvw4x 26, 0, %0\n\t"
                         "lxvw4x 25, 0, %0\n\t"
                         "lxvw4x 24, 0, %0\n\t"
                         "lxvw4x 23, 0, %0\n\t"
                         "lxvw4x 22, 0, %0\n\t"
                         "lxvw4x 21, 0, %0\n\t"
                         "lxvw4x 20, 0, %0\n\t"
                         "lxvw4x 19, 0, %0\n\t"
                         "lxvw4x 18, 0, %0\n\t"
                         "lxvw4x 17, 0, %0\n\t"
                         "lxvw4x 16, 0, %0\n\t"
                         "lxvw4x 15, 0, %0\n\t"
                         "lxvw4x 14, 0, %0\n\t"
                         "lxvw4x 13, 0, %0\n\t"
                         "lxvw4x 12, 0, %0\n\t"
                         "lxvw4x 11, 0, %0\n\t"
                         "lxvw4x 10, 0, %0\n\t"
                         "lxvw4x  9, 0, %0\n\t"
                         "lxvw4x  8, 0, %0\n\t"
                         "lxvw4x  7, 0, %0\n\t"
                         "lxvw4x  6, 0, %0\n\t"
                         "lxvw4x  5, 0, %0\n\t"
                         "lxvw4x  4, 0, %0\n\t"
                         "lxvw4x  3, 0, %0\n\t"
                         "lxvw4x  2, 0, %0\n\t"
                         "lxvw4x  1, 0, %0\n\t"
                         "lxvw4x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmaddasp 63, 63, 63\n\t"
                         "xvmaddasp 62, 62, 62\n\t"
                         "xvmaddasp 61, 61, 61\n\t"
                         "xvmaddasp 60, 60, 60\n\t"
                         "xvmaddasp 59, 59, 59\n\t"
                         "xvmaddasp 58, 58, 58\n\t"
                         "xvmaddasp 57, 57, 57\n\t"
                         "xvmaddasp 56, 56, 56\n\t"
                         "xvmaddasp 55, 55, 55\n\t"
                         "xvmaddasp 54, 54, 54\n\t"
                         "xvmaddasp 53, 53, 53\n\t"
                         "xvmaddasp 52, 52, 52\n\t"
                         "xvmaddasp 51, 51, 51\n\t"
                         "xvmaddasp 50, 50, 50\n\t"
                         "xvmaddasp 49, 49, 49\n\t"
                         "xvmaddasp 48, 48, 48\n\t"
                         "xvmaddasp 47, 47, 47\n\t"
                         "xvmaddasp 46, 46, 46\n\t"
                         "xvmaddasp 45, 45, 45\n\t"
                         "xvmaddasp 44, 44, 44\n\t"
                         "xvmaddasp 43, 43, 43\n\t"
                         "xvmaddasp 42, 42, 42\n\t"
                         "xvmaddasp 41, 41, 41\n\t"
                         "xvmaddasp 40, 40, 40\n\t"
                         "xvmaddasp 39, 39, 39\n\t"
                         "xvmaddasp 38, 38, 38\n\t"
                         "xvmaddasp 37, 37, 37\n\t"
                         "xvmaddasp 36, 36, 36\n\t"
                         "xvmaddasp 35, 35, 35\n\t"
                         "xvmaddasp 34, 34, 34\n\t"
                         "xvmaddasp 33, 33, 33\n\t"
                         "xvmaddasp 32, 32, 32\n\t"
                         "xvmaddasp 31, 31, 31\n\t"
                         "xvmaddasp 30, 30, 30\n\t"
                         "xvmaddasp 29, 29, 29\n\t"
                         "xvmaddasp 28, 28, 28\n\t"
                         "xvmaddasp 27, 27, 27\n\t"
                         "xvmaddasp 26, 26, 26\n\t"
                         "xvmaddasp 25, 25, 25\n\t"
                         "xvmaddasp 24, 24, 24\n\t"
                         "xvmaddasp 23, 23, 23\n\t"
                         "xvmaddasp 22, 22, 22\n\t"
                         "xvmaddasp 21, 21, 21\n\t"
                         "xvmaddasp 20, 20, 20\n\t"
                         "xvmaddasp 19, 19, 19\n\t"
                         "xvmaddasp 18, 18, 18\n\t"
                         "xvmaddasp 17, 17, 17\n\t"
                         "xvmaddasp 16, 16, 16\n\t"
                         "xvmaddasp 15, 15, 15\n\t"
                         "xvmaddasp 14, 14, 14\n\t"
                         "xvmaddasp 13, 13, 13\n\t"
                         "xvmaddasp 12, 12, 12\n\t"
                         "xvmaddasp 11, 11, 11\n\t"
                         "xvmaddasp 10, 10, 10\n\t"
                         "xvmaddasp  9,  9,  9\n\t"
                         "xvmaddasp  8,  8,  8\n\t"
                         "xvmaddasp  7,  7,  7\n\t"
                         "xvmaddasp  6,  6,  6\n\t"
                         "xvmaddasp  5,  5,  5\n\t"
                         "xvmaddasp  4,  4,  4\n\t"
                         "xvmaddasp  3,  3,  3\n\t"
                         "xvmaddasp  2,  2,  2\n\t"
                         "xvmaddasp  1,  1,  1\n\t"
                         "xvmaddasp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data),"r"(&g_reps_float_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}

void gflops_float_mul(float* data) {
    __asm__ __volatile__("lxvw4x 63, 0, %0\n\t"
                         "lxvw4x 62, 0, %0\n\t"
                         "lxvw4x 61, 0, %0\n\t"
                         "lxvw4x 60, 0, %0\n\t"
                         "lxvw4x 59, 0, %0\n\t"
                         "lxvw4x 58, 0, %0\n\t"
                         "lxvw4x 57, 0, %0\n\t"
                         "lxvw4x 56, 0, %0\n\t"
                         "lxvw4x 55, 0, %0\n\t"
                         "lxvw4x 54, 0, %0\n\t"
                         "lxvw4x 53, 0, %0\n\t"
                         "lxvw4x 52, 0, %0\n\t"
                         "lxvw4x 51, 0, %0\n\t"
                         "lxvw4x 50, 0, %0\n\t"
                         "lxvw4x 49, 0, %0\n\t"
                         "lxvw4x 48, 0, %0\n\t"
                         "lxvw4x 47, 0, %0\n\t"
                         "lxvw4x 46, 0, %0\n\t"
                         "lxvw4x 45, 0, %0\n\t"
                         "lxvw4x 44, 0, %0\n\t"
                         "lxvw4x 43, 0, %0\n\t"
                         "lxvw4x 42, 0, %0\n\t"
                         "lxvw4x 41, 0, %0\n\t"
                         "lxvw4x 40, 0, %0\n\t"
                         "lxvw4x 39, 0, %0\n\t"
                         "lxvw4x 38, 0, %0\n\t"
                         "lxvw4x 37, 0, %0\n\t"
                         "lxvw4x 36, 0, %0\n\t"
                         "lxvw4x 35, 0, %0\n\t"
                         "lxvw4x 34, 0, %0\n\t"
                         "lxvw4x 33, 0, %0\n\t"
                         "lxvw4x 32, 0, %0\n\t"
                         "lxvw4x 31, 0, %0\n\t"
                         "lxvw4x 30, 0, %0\n\t"
                         "lxvw4x 29, 0, %0\n\t"
                         "lxvw4x 28, 0, %0\n\t"
                         "lxvw4x 27, 0, %0\n\t"
                         "lxvw4x 26, 0, %0\n\t"
                         "lxvw4x 25, 0, %0\n\t"
                         "lxvw4x 24, 0, %0\n\t"
                         "lxvw4x 23, 0, %0\n\t"
                         "lxvw4x 22, 0, %0\n\t"
                         "lxvw4x 21, 0, %0\n\t"
                         "lxvw4x 20, 0, %0\n\t"
                         "lxvw4x 19, 0, %0\n\t"
                         "lxvw4x 18, 0, %0\n\t"
                         "lxvw4x 17, 0, %0\n\t"
                         "lxvw4x 16, 0, %0\n\t"
                         "lxvw4x 15, 0, %0\n\t"
                         "lxvw4x 14, 0, %0\n\t"
                         "lxvw4x 13, 0, %0\n\t"
                         "lxvw4x 12, 0, %0\n\t"
                         "lxvw4x 11, 0, %0\n\t"
                         "lxvw4x 10, 0, %0\n\t"
                         "lxvw4x  9, 0, %0\n\t"
                         "lxvw4x  8, 0, %0\n\t"
                         "lxvw4x  7, 0, %0\n\t"
                         "lxvw4x  6, 0, %0\n\t"
                         "lxvw4x  5, 0, %0\n\t"
                         "lxvw4x  4, 0, %0\n\t"
                         "lxvw4x  3, 0, %0\n\t"
                         "lxvw4x  2, 0, %0\n\t"
                         "lxvw4x  1, 0, %0\n\t"
                         "lxvw4x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmulsp 63, 63, 63\n\t"
                         "xvmulsp 62, 62, 62\n\t"
                         "xvmulsp 61, 61, 61\n\t"
                         "xvmulsp 60, 60, 60\n\t"
                         "xvmulsp 59, 59, 59\n\t"
                         "xvmulsp 58, 58, 58\n\t"
                         "xvmulsp 57, 57, 57\n\t"
                         "xvmulsp 56, 56, 56\n\t"
                         "xvmulsp 55, 55, 55\n\t"
                         "xvmulsp 54, 54, 54\n\t"
                         "xvmulsp 53, 53, 53\n\t"
                         "xvmulsp 52, 52, 52\n\t"
                         "xvmulsp 51, 51, 51\n\t"
                         "xvmulsp 50, 50, 50\n\t"
                         "xvmulsp 49, 49, 49\n\t"
                         "xvmulsp 48, 48, 48\n\t"
                         "xvmulsp 47, 47, 47\n\t"
                         "xvmulsp 46, 46, 46\n\t"
                         "xvmulsp 45, 45, 45\n\t"
                         "xvmulsp 44, 44, 44\n\t"
                         "xvmulsp 43, 43, 43\n\t"
                         "xvmulsp 42, 42, 42\n\t"
                         "xvmulsp 41, 41, 41\n\t"
                         "xvmulsp 40, 40, 40\n\t"
                         "xvmulsp 39, 39, 39\n\t"
                         "xvmulsp 38, 38, 38\n\t"
                         "xvmulsp 37, 37, 37\n\t"
                         "xvmulsp 36, 36, 36\n\t"
                         "xvmulsp 35, 35, 35\n\t"
                         "xvmulsp 34, 34, 34\n\t"
                         "xvmulsp 33, 33, 33\n\t"
                         "xvmulsp 32, 32, 32\n\t"
                         "xvmulsp 31, 31, 31\n\t"
                         "xvmulsp 30, 30, 30\n\t"
                         "xvmulsp 29, 29, 29\n\t"
                         "xvmulsp 28, 28, 28\n\t"
                         "xvmulsp 27, 27, 27\n\t"
                         "xvmulsp 26, 26, 26\n\t"
                         "xvmulsp 25, 25, 25\n\t"
                         "xvmulsp 24, 24, 24\n\t"
                         "xvmulsp 23, 23, 23\n\t"
                         "xvmulsp 22, 22, 22\n\t"
                         "xvmulsp 21, 21, 21\n\t"
                         "xvmulsp 20, 20, 20\n\t"
                         "xvmulsp 19, 19, 19\n\t"
                         "xvmulsp 18, 18, 18\n\t"
                         "xvmulsp 17, 17, 17\n\t"
                         "xvmulsp 16, 16, 16\n\t"
                         "xvmulsp 15, 15, 15\n\t"
                         "xvmulsp 14, 14, 14\n\t"
                         "xvmulsp 13, 13, 13\n\t"
                         "xvmulsp 12, 12, 12\n\t"
                         "xvmulsp 11, 11, 11\n\t"
                         "xvmulsp 10, 10, 10\n\t"
                         "xvmulsp  9,  9,  9\n\t"
                         "xvmulsp  8,  8,  8\n\t"
                         "xvmulsp  7,  7,  7\n\t"
                         "xvmulsp  6,  6,  6\n\t"
                         "xvmulsp  5,  5,  5\n\t"
                         "xvmulsp  4,  4,  4\n\t"
                         "xvmulsp  3,  3,  3\n\t"
                         "xvmulsp  2,  2,  2\n\t"
                         "xvmulsp  1,  1,  1\n\t"
                         "xvmulsp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_float_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}

void gflops_float_add(float* data) {
    __asm__ __volatile__("lxvw4x 63, 0, %0\n\t"
                         "lxvw4x 62, 0, %0\n\t"
                         "lxvw4x 61, 0, %0\n\t"
                         "lxvw4x 60, 0, %0\n\t"
                         "lxvw4x 59, 0, %0\n\t"
                         "lxvw4x 58, 0, %0\n\t"
                         "lxvw4x 57, 0, %0\n\t"
                         "lxvw4x 56, 0, %0\n\t"
                         "lxvw4x 55, 0, %0\n\t"
                         "lxvw4x 54, 0, %0\n\t"
                         "lxvw4x 53, 0, %0\n\t"
                         "lxvw4x 52, 0, %0\n\t"
                         "lxvw4x 51, 0, %0\n\t"
                         "lxvw4x 50, 0, %0\n\t"
                         "lxvw4x 49, 0, %0\n\t"
                         "lxvw4x 48, 0, %0\n\t"
                         "lxvw4x 47, 0, %0\n\t"
                         "lxvw4x 46, 0, %0\n\t"
                         "lxvw4x 45, 0, %0\n\t"
                         "lxvw4x 44, 0, %0\n\t"
                         "lxvw4x 43, 0, %0\n\t"
                         "lxvw4x 42, 0, %0\n\t"
                         "lxvw4x 41, 0, %0\n\t"
                         "lxvw4x 40, 0, %0\n\t"
                         "lxvw4x 39, 0, %0\n\t"
                         "lxvw4x 38, 0, %0\n\t"
                         "lxvw4x 37, 0, %0\n\t"
                         "lxvw4x 36, 0, %0\n\t"
                         "lxvw4x 35, 0, %0\n\t"
                         "lxvw4x 34, 0, %0\n\t"
                         "lxvw4x 33, 0, %0\n\t"
                         "lxvw4x 32, 0, %0\n\t"
                         "lxvw4x 31, 0, %0\n\t"
                         "lxvw4x 30, 0, %0\n\t"
                         "lxvw4x 29, 0, %0\n\t"
                         "lxvw4x 28, 0, %0\n\t"
                         "lxvw4x 27, 0, %0\n\t"
                         "lxvw4x 26, 0, %0\n\t"
                         "lxvw4x 25, 0, %0\n\t"
                         "lxvw4x 24, 0, %0\n\t"
                         "lxvw4x 23, 0, %0\n\t"
                         "lxvw4x 22, 0, %0\n\t"
                         "lxvw4x 21, 0, %0\n\t"
                         "lxvw4x 20, 0, %0\n\t"
                         "lxvw4x 19, 0, %0\n\t"
                         "lxvw4x 18, 0, %0\n\t"
                         "lxvw4x 17, 0, %0\n\t"
                         "lxvw4x 16, 0, %0\n\t"
                         "lxvw4x 15, 0, %0\n\t"
                         "lxvw4x 14, 0, %0\n\t"
                         "lxvw4x 13, 0, %0\n\t"
                         "lxvw4x 12, 0, %0\n\t"
                         "lxvw4x 11, 0, %0\n\t"
                         "lxvw4x 10, 0, %0\n\t"
                         "lxvw4x  9, 0, %0\n\t"
                         "lxvw4x  8, 0, %0\n\t"
                         "lxvw4x  7, 0, %0\n\t"
                         "lxvw4x  6, 0, %0\n\t"
                         "lxvw4x  5, 0, %0\n\t"
                         "lxvw4x  4, 0, %0\n\t"
                         "lxvw4x  3, 0, %0\n\t"
                         "lxvw4x  2, 0, %0\n\t"
                         "lxvw4x  1, 0, %0\n\t"
                         "lxvw4x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvaddsp 63, 63, 63\n\t"
                         "xvaddsp 62, 62, 62\n\t"
                         "xvaddsp 61, 61, 61\n\t"
                         "xvaddsp 60, 60, 60\n\t"
                         "xvaddsp 59, 59, 59\n\t"
                         "xvaddsp 58, 58, 58\n\t"
                         "xvaddsp 57, 57, 57\n\t"
                         "xvaddsp 56, 56, 56\n\t"
                         "xvaddsp 55, 55, 55\n\t"
                         "xvaddsp 54, 54, 54\n\t"
                         "xvaddsp 53, 53, 53\n\t"
                         "xvaddsp 52, 52, 52\n\t"
                         "xvaddsp 51, 51, 51\n\t"
                         "xvaddsp 50, 50, 50\n\t"
                         "xvaddsp 49, 49, 49\n\t"
                         "xvaddsp 48, 48, 48\n\t"
                         "xvaddsp 47, 47, 47\n\t"
                         "xvaddsp 46, 46, 46\n\t"
                         "xvaddsp 45, 45, 45\n\t"
                         "xvaddsp 44, 44, 44\n\t"
                         "xvaddsp 43, 43, 43\n\t"
                         "xvaddsp 42, 42, 42\n\t"
                         "xvaddsp 41, 41, 41\n\t"
                         "xvaddsp 40, 40, 40\n\t"
                         "xvaddsp 39, 39, 39\n\t"
                         "xvaddsp 38, 38, 38\n\t"
                         "xvaddsp 37, 37, 37\n\t"
                         "xvaddsp 36, 36, 36\n\t"
                         "xvaddsp 35, 35, 35\n\t"
                         "xvaddsp 34, 34, 34\n\t"
                         "xvaddsp 33, 33, 33\n\t"
                         "xvaddsp 32, 32, 32\n\t"
                         "xvaddsp 31, 31, 31\n\t"
                         "xvaddsp 30, 30, 30\n\t"
                         "xvaddsp 29, 29, 29\n\t"
                         "xvaddsp 28, 28, 28\n\t"
                         "xvaddsp 27, 27, 27\n\t"
                         "xvaddsp 26, 26, 26\n\t"
                         "xvaddsp 25, 25, 25\n\t"
                         "xvaddsp 24, 24, 24\n\t"
                         "xvaddsp 23, 23, 23\n\t"
                         "xvaddsp 22, 22, 22\n\t"
                         "xvaddsp 21, 21, 21\n\t"
                         "xvaddsp 20, 20, 20\n\t"
                         "xvaddsp 19, 19, 19\n\t"
                         "xvaddsp 18, 18, 18\n\t"
                         "xvaddsp 17, 17, 17\n\t"
                         "xvaddsp 16, 16, 16\n\t"
                         "xvaddsp 15, 15, 15\n\t"
                         "xvaddsp 14, 14, 14\n\t"
                         "xvaddsp 13, 13, 13\n\t"
                         "xvaddsp 12, 12, 12\n\t"
                         "xvaddsp 11, 11, 11\n\t"
                         "xvaddsp 10, 10, 10\n\t"
                         "xvaddsp  9,  9,  9\n\t"
                         "xvaddsp  8,  8,  8\n\t"
                         "xvaddsp  7,  7,  7\n\t"
                         "xvaddsp  6,  6,  6\n\t"
                         "xvaddsp  5,  5,  5\n\t"
                         "xvaddsp  4,  4,  4\n\t"
                         "xvaddsp  3,  3,  3\n\t"
                         "xvaddsp  2,  2,  2\n\t"
                         "xvaddsp  1,  1,  1\n\t"
                         "xvaddsp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_float_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}

void gflops_float_madd(float* data) {
    __asm__ __volatile__("lxvw4x 63, 0, %0\n\t"
                         "lxvw4x 62, 0, %0\n\t"
                         "lxvw4x 61, 0, %0\n\t"
                         "lxvw4x 60, 0, %0\n\t"
                         "lxvw4x 59, 0, %0\n\t"
                         "lxvw4x 58, 0, %0\n\t"
                         "lxvw4x 57, 0, %0\n\t"
                         "lxvw4x 56, 0, %0\n\t"
                         "lxvw4x 55, 0, %0\n\t"
                         "lxvw4x 54, 0, %0\n\t"
                         "lxvw4x 53, 0, %0\n\t"
                         "lxvw4x 52, 0, %0\n\t"
                         "lxvw4x 51, 0, %0\n\t"
                         "lxvw4x 50, 0, %0\n\t"
                         "lxvw4x 49, 0, %0\n\t"
                         "lxvw4x 48, 0, %0\n\t"
                         "lxvw4x 47, 0, %0\n\t"
                         "lxvw4x 46, 0, %0\n\t"
                         "lxvw4x 45, 0, %0\n\t"
                         "lxvw4x 44, 0, %0\n\t"
                         "lxvw4x 43, 0, %0\n\t"
                         "lxvw4x 42, 0, %0\n\t"
                         "lxvw4x 41, 0, %0\n\t"
                         "lxvw4x 40, 0, %0\n\t"
                         "lxvw4x 39, 0, %0\n\t"
                         "lxvw4x 38, 0, %0\n\t"
                         "lxvw4x 37, 0, %0\n\t"
                         "lxvw4x 36, 0, %0\n\t"
                         "lxvw4x 35, 0, %0\n\t"
                         "lxvw4x 34, 0, %0\n\t"
                         "lxvw4x 33, 0, %0\n\t"
                         "lxvw4x 32, 0, %0\n\t"
                         "lxvw4x 31, 0, %0\n\t"
                         "lxvw4x 30, 0, %0\n\t"
                         "lxvw4x 29, 0, %0\n\t"
                         "lxvw4x 28, 0, %0\n\t"
                         "lxvw4x 27, 0, %0\n\t"
                         "lxvw4x 26, 0, %0\n\t"
                         "lxvw4x 25, 0, %0\n\t"
                         "lxvw4x 24, 0, %0\n\t"
                         "lxvw4x 23, 0, %0\n\t"
                         "lxvw4x 22, 0, %0\n\t"
                         "lxvw4x 21, 0, %0\n\t"
                         "lxvw4x 20, 0, %0\n\t"
                         "lxvw4x 19, 0, %0\n\t"
                         "lxvw4x 18, 0, %0\n\t"
                         "lxvw4x 17, 0, %0\n\t"
                         "lxvw4x 16, 0, %0\n\t"
                         "lxvw4x 15, 0, %0\n\t"
                         "lxvw4x 14, 0, %0\n\t"
                         "lxvw4x 13, 0, %0\n\t"
                         "lxvw4x 12, 0, %0\n\t"
                         "lxvw4x 11, 0, %0\n\t"
                         "lxvw4x 10, 0, %0\n\t"
                         "lxvw4x  9, 0, %0\n\t"
                         "lxvw4x  8, 0, %0\n\t"
                         "lxvw4x  7, 0, %0\n\t"
                         "lxvw4x  6, 0, %0\n\t"
                         "lxvw4x  5, 0, %0\n\t"
                         "lxvw4x  4, 0, %0\n\t"
                         "lxvw4x  3, 0, %0\n\t"
                         "lxvw4x  2, 0, %0\n\t"
                         "lxvw4x  1, 0, %0\n\t"
                         "lxvw4x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmulsp 63, 63, 63\n\t"
                         "xvaddsp 62, 62, 62\n\t"
                         "xvmulsp 61, 61, 61\n\t"
                         "xvaddsp 60, 60, 60\n\t"
                         "xvmulsp 59, 59, 59\n\t"
                         "xvaddsp 58, 58, 58\n\t"
                         "xvmulsp 57, 57, 57\n\t"
                         "xvaddsp 56, 56, 56\n\t"
                         "xvmulsp 55, 55, 55\n\t"
                         "xvaddsp 54, 54, 54\n\t"
                         "xvmulsp 53, 53, 53\n\t"
                         "xvaddsp 52, 52, 52\n\t"
                         "xvmulsp 51, 51, 51\n\t"
                         "xvaddsp 50, 50, 50\n\t"
                         "xvmulsp 49, 49, 49\n\t"
                         "xvaddsp 48, 48, 48\n\t"
                         "xvmulsp 47, 47, 47\n\t"
                         "xvaddsp 46, 46, 46\n\t"
                         "xvmulsp 45, 45, 45\n\t"
                         "xvaddsp 44, 44, 44\n\t"
                         "xvmulsp 43, 43, 43\n\t"
                         "xvaddsp 42, 42, 42\n\t"
                         "xvmulsp 41, 41, 41\n\t"
                         "xvaddsp 40, 40, 40\n\t"
                         "xvmulsp 39, 39, 39\n\t"
                         "xvaddsp 38, 38, 38\n\t"
                         "xvmulsp 37, 37, 37\n\t"
                         "xvaddsp 36, 36, 36\n\t"
                         "xvmulsp 35, 35, 35\n\t"
                         "xvaddsp 34, 34, 34\n\t"
                         "xvmulsp 33, 33, 33\n\t"
                         "xvaddsp 32, 32, 32\n\t"
                         "xvmulsp 31, 31, 31\n\t"
                         "xvaddsp 30, 30, 30\n\t"
                         "xvmulsp 29, 29, 29\n\t"
                         "xvaddsp 28, 28, 28\n\t"
                         "xvmulsp 27, 27, 27\n\t"
                         "xvaddsp 26, 26, 26\n\t"
                         "xvmulsp 25, 25, 25\n\t"
                         "xvaddsp 24, 24, 24\n\t"
                         "xvmulsp 23, 23, 23\n\t"
                         "xvaddsp 22, 22, 22\n\t"
                         "xvmulsp 21, 21, 21\n\t"
                         "xvaddsp 20, 20, 20\n\t"
                         "xvmulsp 19, 19, 19\n\t"
                         "xvaddsp 18, 18, 18\n\t"
                         "xvmulsp 17, 17, 17\n\t"
                         "xvaddsp 16, 16, 16\n\t"
                         "xvmulsp 15, 15, 15\n\t"
                         "xvaddsp 14, 14, 14\n\t"
                         "xvmulsp 13, 13, 13\n\t"
                         "xvaddsp 12, 12, 12\n\t"
                         "xvmulsp 11, 11, 11\n\t"
                         "xvaddsp 10, 10, 10\n\t"
                         "xvmulsp  9,  9,  9\n\t"
                         "xvaddsp  8,  8,  8\n\t"
                         "xvmulsp  7,  7,  7\n\t"
                         "xvaddsp  6,  6,  6\n\t"
                         "xvmulsp  5,  5,  5\n\t"
                         "xvaddsp  4,  4,  4\n\t"
                         "xvmulsp  3,  3,  3\n\t"
                         "xvaddsp  2,  2,  2\n\t"
                         "xvmulsp  1,  1,  1\n\t"
                         "xvaddsp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_float_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}


