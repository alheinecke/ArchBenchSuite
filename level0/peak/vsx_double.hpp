/******************************************************************************
** Copyright (c) 2013-2018, Alexander Heinecke                               **
** All rights reserved.                                                      **
**                                                                           **
** Redistribution and use in source and binary forms, with or without        **
** modification, are permitted provided that the following conditions        **
** are met:                                                                  **
** 1. Redistributions of source code must retain the above copyright         **
**    notice, this list of conditions and the following disclaimer.          **
** 2. Redistributions in binary form must reproduce the above copyright      **
**    notice, this list of conditions and the following disclaimer in the    **
**    documentation and/or other materials provided with the distribution.   **
** 3. Neither the name of the copyright holder nor the names of its          **
**    contributors may be used to endorse or promote products derived        **
**    from this software without specific prior written permission.          **
**                                                                           **
** THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS       **
** "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT         **
** LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR     **
** A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT      **
** HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,    **
** SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED  **
** TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR    **
** PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF    **
** LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING      **
** NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS        **
** SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.              **
******************************************************************************/

size_t g_reps_double_power8 = 100000000;

void gflops_double_qfma(double* data) {
  std::cout << "QFMA is not available on this architecture" << std::endl;
}

void gflops_double_fma(double* data) {
    __asm__ __volatile__("lxvd2x 63, 0, %0\n\t"
                         "lxvd2x 62, 0, %0\n\t"
                         "lxvd2x 61, 0, %0\n\t"
                         "lxvd2x 60, 0, %0\n\t"
                         "lxvd2x 59, 0, %0\n\t"
                         "lxvd2x 58, 0, %0\n\t"
                         "lxvd2x 57, 0, %0\n\t"
                         "lxvd2x 56, 0, %0\n\t"
                         "lxvd2x 55, 0, %0\n\t"
                         "lxvd2x 54, 0, %0\n\t"
                         "lxvd2x 53, 0, %0\n\t"
                         "lxvd2x 52, 0, %0\n\t"
                         "lxvd2x 51, 0, %0\n\t"
                         "lxvd2x 50, 0, %0\n\t"
                         "lxvd2x 49, 0, %0\n\t"
                         "lxvd2x 48, 0, %0\n\t"
                         "lxvd2x 47, 0, %0\n\t"
                         "lxvd2x 46, 0, %0\n\t"
                         "lxvd2x 45, 0, %0\n\t"
                         "lxvd2x 44, 0, %0\n\t"
                         "lxvd2x 43, 0, %0\n\t"
                         "lxvd2x 42, 0, %0\n\t"
                         "lxvd2x 41, 0, %0\n\t"
                         "lxvd2x 40, 0, %0\n\t"
                         "lxvd2x 39, 0, %0\n\t"
                         "lxvd2x 38, 0, %0\n\t"
                         "lxvd2x 37, 0, %0\n\t"
                         "lxvd2x 36, 0, %0\n\t"
                         "lxvd2x 35, 0, %0\n\t"
                         "lxvd2x 34, 0, %0\n\t"
                         "lxvd2x 33, 0, %0\n\t"
                         "lxvd2x 32, 0, %0\n\t"
                         "lxvd2x 31, 0, %0\n\t"
                         "lxvd2x 30, 0, %0\n\t"
                         "lxvd2x 29, 0, %0\n\t"
                         "lxvd2x 28, 0, %0\n\t"
                         "lxvd2x 27, 0, %0\n\t"
                         "lxvd2x 26, 0, %0\n\t"
                         "lxvd2x 25, 0, %0\n\t"
                         "lxvd2x 24, 0, %0\n\t"
                         "lxvd2x 23, 0, %0\n\t"
                         "lxvd2x 22, 0, %0\n\t"
                         "lxvd2x 21, 0, %0\n\t"
                         "lxvd2x 20, 0, %0\n\t"
                         "lxvd2x 19, 0, %0\n\t"
                         "lxvd2x 18, 0, %0\n\t"
                         "lxvd2x 17, 0, %0\n\t"
                         "lxvd2x 16, 0, %0\n\t"
                         "lxvd2x 15, 0, %0\n\t"
                         "lxvd2x 14, 0, %0\n\t"
                         "lxvd2x 13, 0, %0\n\t"
                         "lxvd2x 12, 0, %0\n\t"
                         "lxvd2x 11, 0, %0\n\t"
                         "lxvd2x 10, 0, %0\n\t"
                         "lxvd2x  9, 0, %0\n\t"
                         "lxvd2x  8, 0, %0\n\t"
                         "lxvd2x  7, 0, %0\n\t"
                         "lxvd2x  6, 0, %0\n\t"
                         "lxvd2x  5, 0, %0\n\t"
                         "lxvd2x  4, 0, %0\n\t"
                         "lxvd2x  3, 0, %0\n\t"
                         "lxvd2x  2, 0, %0\n\t"
                         "lxvd2x  1, 0, %0\n\t"
                         "lxvd2x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmaddadp 63, 63, 63\n\t"
                         "xvmaddadp 62, 62, 62\n\t"
                         "xvmaddadp 61, 61, 61\n\t"
                         "xvmaddadp 60, 60, 60\n\t"
                         "xvmaddadp 59, 59, 59\n\t"
                         "xvmaddadp 58, 58, 58\n\t"
                         "xvmaddadp 57, 57, 57\n\t"
                         "xvmaddadp 56, 56, 56\n\t"
                         "xvmaddadp 55, 55, 55\n\t"
                         "xvmaddadp 54, 54, 54\n\t"
                         "xvmaddadp 53, 53, 53\n\t"
                         "xvmaddadp 52, 52, 52\n\t"
                         "xvmaddadp 51, 51, 51\n\t"
                         "xvmaddadp 50, 50, 50\n\t"
                         "xvmaddadp 49, 49, 49\n\t"
                         "xvmaddadp 48, 48, 48\n\t"
                         "xvmaddadp 47, 47, 47\n\t"
                         "xvmaddadp 46, 46, 46\n\t"
                         "xvmaddadp 45, 45, 45\n\t"
                         "xvmaddadp 44, 44, 44\n\t"
                         "xvmaddadp 43, 43, 43\n\t"
                         "xvmaddadp 42, 42, 42\n\t"
                         "xvmaddadp 41, 41, 41\n\t"
                         "xvmaddadp 40, 40, 40\n\t"
                         "xvmaddadp 39, 39, 39\n\t"
                         "xvmaddadp 38, 38, 38\n\t"
                         "xvmaddadp 37, 37, 37\n\t"
                         "xvmaddadp 36, 36, 36\n\t"
                         "xvmaddadp 35, 35, 35\n\t"
                         "xvmaddadp 34, 34, 34\n\t"
                         "xvmaddadp 33, 33, 33\n\t"
                         "xvmaddadp 32, 32, 32\n\t"
                         "xvmaddadp 31, 31, 31\n\t"
                         "xvmaddadp 30, 30, 30\n\t"
                         "xvmaddadp 29, 29, 29\n\t"
                         "xvmaddadp 28, 28, 28\n\t"
                         "xvmaddadp 27, 27, 27\n\t"
                         "xvmaddadp 26, 26, 26\n\t"
                         "xvmaddadp 25, 25, 25\n\t"
                         "xvmaddadp 24, 24, 24\n\t"
                         "xvmaddadp 23, 23, 23\n\t"
                         "xvmaddadp 22, 22, 22\n\t"
                         "xvmaddadp 21, 21, 21\n\t"
                         "xvmaddadp 20, 20, 20\n\t"
                         "xvmaddadp 19, 19, 19\n\t"
                         "xvmaddadp 18, 18, 18\n\t"
                         "xvmaddadp 17, 17, 17\n\t"
                         "xvmaddadp 16, 16, 16\n\t"
                         "xvmaddadp 15, 15, 15\n\t"
                         "xvmaddadp 14, 14, 14\n\t"
                         "xvmaddadp 13, 13, 13\n\t"
                         "xvmaddadp 12, 12, 12\n\t"
                         "xvmaddadp 11, 11, 11\n\t"
                         "xvmaddadp 10, 10, 10\n\t"
                         "xvmaddadp  9,  9,  9\n\t"
                         "xvmaddadp  8,  8,  8\n\t"
                         "xvmaddadp  7,  7,  7\n\t"
                         "xvmaddadp  6,  6,  6\n\t"
                         "xvmaddadp  5,  5,  5\n\t"
                         "xvmaddadp  4,  4,  4\n\t"
                         "xvmaddadp  3,  3,  3\n\t"
                         "xvmaddadp  2,  2,  2\n\t"
                         "xvmaddadp  1,  1,  1\n\t"
                         "xvmaddadp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_double_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}


void gflops_double_mul(double* data) {
    __asm__ __volatile__("lxvd2x 63, 0, %0\n\t"
                         "lxvd2x 62, 0, %0\n\t"
                         "lxvd2x 61, 0, %0\n\t"
                         "lxvd2x 60, 0, %0\n\t"
                         "lxvd2x 59, 0, %0\n\t"
                         "lxvd2x 58, 0, %0\n\t"
                         "lxvd2x 57, 0, %0\n\t"
                         "lxvd2x 56, 0, %0\n\t"
                         "lxvd2x 55, 0, %0\n\t"
                         "lxvd2x 54, 0, %0\n\t"
                         "lxvd2x 53, 0, %0\n\t"
                         "lxvd2x 52, 0, %0\n\t"
                         "lxvd2x 51, 0, %0\n\t"
                         "lxvd2x 50, 0, %0\n\t"
                         "lxvd2x 49, 0, %0\n\t"
                         "lxvd2x 48, 0, %0\n\t"
                         "lxvd2x 47, 0, %0\n\t"
                         "lxvd2x 46, 0, %0\n\t"
                         "lxvd2x 45, 0, %0\n\t"
                         "lxvd2x 44, 0, %0\n\t"
                         "lxvd2x 43, 0, %0\n\t"
                         "lxvd2x 42, 0, %0\n\t"
                         "lxvd2x 41, 0, %0\n\t"
                         "lxvd2x 40, 0, %0\n\t"
                         "lxvd2x 39, 0, %0\n\t"
                         "lxvd2x 38, 0, %0\n\t"
                         "lxvd2x 37, 0, %0\n\t"
                         "lxvd2x 36, 0, %0\n\t"
                         "lxvd2x 35, 0, %0\n\t"
                         "lxvd2x 34, 0, %0\n\t"
                         "lxvd2x 33, 0, %0\n\t"
                         "lxvd2x 32, 0, %0\n\t"
                         "lxvd2x 31, 0, %0\n\t"
                         "lxvd2x 30, 0, %0\n\t"
                         "lxvd2x 29, 0, %0\n\t"
                         "lxvd2x 28, 0, %0\n\t"
                         "lxvd2x 27, 0, %0\n\t"
                         "lxvd2x 26, 0, %0\n\t"
                         "lxvd2x 25, 0, %0\n\t"
                         "lxvd2x 24, 0, %0\n\t"
                         "lxvd2x 23, 0, %0\n\t"
                         "lxvd2x 22, 0, %0\n\t"
                         "lxvd2x 21, 0, %0\n\t"
                         "lxvd2x 20, 0, %0\n\t"
                         "lxvd2x 19, 0, %0\n\t"
                         "lxvd2x 18, 0, %0\n\t"
                         "lxvd2x 17, 0, %0\n\t"
                         "lxvd2x 16, 0, %0\n\t"
                         "lxvd2x 15, 0, %0\n\t"
                         "lxvd2x 14, 0, %0\n\t"
                         "lxvd2x 13, 0, %0\n\t"
                         "lxvd2x 12, 0, %0\n\t"
                         "lxvd2x 11, 0, %0\n\t"
                         "lxvd2x 10, 0, %0\n\t"
                         "lxvd2x  9, 0, %0\n\t"
                         "lxvd2x  8, 0, %0\n\t"
                         "lxvd2x  7, 0, %0\n\t"
                         "lxvd2x  6, 0, %0\n\t"
                         "lxvd2x  5, 0, %0\n\t"
                         "lxvd2x  4, 0, %0\n\t"
                         "lxvd2x  3, 0, %0\n\t"
                         "lxvd2x  2, 0, %0\n\t"
                         "lxvd2x  1, 0, %0\n\t"
                         "lxvd2x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmuldp 63, 63, 63\n\t"
                         "xvmuldp 62, 62, 62\n\t"
                         "xvmuldp 61, 61, 61\n\t"
                         "xvmuldp 60, 60, 60\n\t"
                         "xvmuldp 59, 59, 59\n\t"
                         "xvmuldp 58, 58, 58\n\t"
                         "xvmuldp 57, 57, 57\n\t"
                         "xvmuldp 56, 56, 56\n\t"
                         "xvmuldp 55, 55, 55\n\t"
                         "xvmuldp 54, 54, 54\n\t"
                         "xvmuldp 53, 53, 53\n\t"
                         "xvmuldp 52, 52, 52\n\t"
                         "xvmuldp 51, 51, 51\n\t"
                         "xvmuldp 50, 50, 50\n\t"
                         "xvmuldp 49, 49, 49\n\t"
                         "xvmuldp 48, 48, 48\n\t"
                         "xvmuldp 47, 47, 47\n\t"
                         "xvmuldp 46, 46, 46\n\t"
                         "xvmuldp 45, 45, 45\n\t"
                         "xvmuldp 44, 44, 44\n\t"
                         "xvmuldp 43, 43, 43\n\t"
                         "xvmuldp 42, 42, 42\n\t"
                         "xvmuldp 41, 41, 41\n\t"
                         "xvmuldp 40, 40, 40\n\t"
                         "xvmuldp 39, 39, 39\n\t"
                         "xvmuldp 38, 38, 38\n\t"
                         "xvmuldp 37, 37, 37\n\t"
                         "xvmuldp 36, 36, 36\n\t"
                         "xvmuldp 35, 35, 35\n\t"
                         "xvmuldp 34, 34, 34\n\t"
                         "xvmuldp 33, 33, 33\n\t"
                         "xvmuldp 32, 32, 32\n\t"
                         "xvmuldp 31, 31, 31\n\t"
                         "xvmuldp 30, 30, 30\n\t"
                         "xvmuldp 29, 29, 29\n\t"
                         "xvmuldp 28, 28, 28\n\t"
                         "xvmuldp 27, 27, 27\n\t"
                         "xvmuldp 26, 26, 26\n\t"
                         "xvmuldp 25, 25, 25\n\t"
                         "xvmuldp 24, 24, 24\n\t"
                         "xvmuldp 23, 23, 23\n\t"
                         "xvmuldp 22, 22, 22\n\t"
                         "xvmuldp 21, 21, 21\n\t"
                         "xvmuldp 20, 20, 20\n\t"
                         "xvmuldp 19, 19, 19\n\t"
                         "xvmuldp 18, 18, 18\n\t"
                         "xvmuldp 17, 17, 17\n\t"
                         "xvmuldp 16, 16, 16\n\t"
                         "xvmuldp 15, 15, 15\n\t"
                         "xvmuldp 14, 14, 14\n\t"
                         "xvmuldp 13, 13, 13\n\t"
                         "xvmuldp 12, 12, 12\n\t"
                         "xvmuldp 11, 11, 11\n\t"
                         "xvmuldp 10, 10, 10\n\t"
                         "xvmuldp  9,  9,  9\n\t"
                         "xvmuldp  8,  8,  8\n\t"
                         "xvmuldp  7,  7,  7\n\t"
                         "xvmuldp  6,  6,  6\n\t"
                         "xvmuldp  5,  5,  5\n\t"
                         "xvmuldp  4,  4,  4\n\t"
                         "xvmuldp  3,  3,  3\n\t"
                         "xvmuldp  2,  2,  2\n\t"
                         "xvmuldp  1,  1,  1\n\t"
                         "xvmuldp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_double_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}

void gflops_double_add(double* data) {
    __asm__ __volatile__("lxvd2x 63, 0, %0\n\t"
                         "lxvd2x 62, 0, %0\n\t"
                         "lxvd2x 61, 0, %0\n\t"
                         "lxvd2x 60, 0, %0\n\t"
                         "lxvd2x 59, 0, %0\n\t"
                         "lxvd2x 58, 0, %0\n\t"
                         "lxvd2x 57, 0, %0\n\t"
                         "lxvd2x 56, 0, %0\n\t"
                         "lxvd2x 55, 0, %0\n\t"
                         "lxvd2x 54, 0, %0\n\t"
                         "lxvd2x 53, 0, %0\n\t"
                         "lxvd2x 52, 0, %0\n\t"
                         "lxvd2x 51, 0, %0\n\t"
                         "lxvd2x 50, 0, %0\n\t"
                         "lxvd2x 49, 0, %0\n\t"
                         "lxvd2x 48, 0, %0\n\t"
                         "lxvd2x 47, 0, %0\n\t"
                         "lxvd2x 46, 0, %0\n\t"
                         "lxvd2x 45, 0, %0\n\t"
                         "lxvd2x 44, 0, %0\n\t"
                         "lxvd2x 43, 0, %0\n\t"
                         "lxvd2x 42, 0, %0\n\t"
                         "lxvd2x 41, 0, %0\n\t"
                         "lxvd2x 40, 0, %0\n\t"
                         "lxvd2x 39, 0, %0\n\t"
                         "lxvd2x 38, 0, %0\n\t"
                         "lxvd2x 37, 0, %0\n\t"
                         "lxvd2x 36, 0, %0\n\t"
                         "lxvd2x 35, 0, %0\n\t"
                         "lxvd2x 34, 0, %0\n\t"
                         "lxvd2x 33, 0, %0\n\t"
                         "lxvd2x 32, 0, %0\n\t"
                         "lxvd2x 31, 0, %0\n\t"
                         "lxvd2x 30, 0, %0\n\t"
                         "lxvd2x 29, 0, %0\n\t"
                         "lxvd2x 28, 0, %0\n\t"
                         "lxvd2x 27, 0, %0\n\t"
                         "lxvd2x 26, 0, %0\n\t"
                         "lxvd2x 25, 0, %0\n\t"
                         "lxvd2x 24, 0, %0\n\t"
                         "lxvd2x 23, 0, %0\n\t"
                         "lxvd2x 22, 0, %0\n\t"
                         "lxvd2x 21, 0, %0\n\t"
                         "lxvd2x 20, 0, %0\n\t"
                         "lxvd2x 19, 0, %0\n\t"
                         "lxvd2x 18, 0, %0\n\t"
                         "lxvd2x 17, 0, %0\n\t"
                         "lxvd2x 16, 0, %0\n\t"
                         "lxvd2x 15, 0, %0\n\t"
                         "lxvd2x 14, 0, %0\n\t"
                         "lxvd2x 13, 0, %0\n\t"
                         "lxvd2x 12, 0, %0\n\t"
                         "lxvd2x 11, 0, %0\n\t"
                         "lxvd2x 10, 0, %0\n\t"
                         "lxvd2x  9, 0, %0\n\t"
                         "lxvd2x  8, 0, %0\n\t"
                         "lxvd2x  7, 0, %0\n\t"
                         "lxvd2x  6, 0, %0\n\t"
                         "lxvd2x  5, 0, %0\n\t"
                         "lxvd2x  4, 0, %0\n\t"
                         "lxvd2x  3, 0, %0\n\t"
                         "lxvd2x  2, 0, %0\n\t"
                         "lxvd2x  1, 0, %0\n\t"
                         "lxvd2x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvadddp 63, 63, 63\n\t"
                         "xvadddp 62, 62, 62\n\t"
                         "xvadddp 61, 61, 61\n\t"
                         "xvadddp 60, 60, 60\n\t"
                         "xvadddp 59, 59, 59\n\t"
                         "xvadddp 58, 58, 58\n\t"
                         "xvadddp 57, 57, 57\n\t"
                         "xvadddp 56, 56, 56\n\t"
                         "xvadddp 55, 55, 55\n\t"
                         "xvadddp 54, 54, 54\n\t"
                         "xvadddp 53, 53, 53\n\t"
                         "xvadddp 52, 52, 52\n\t"
                         "xvadddp 51, 51, 51\n\t"
                         "xvadddp 50, 50, 50\n\t"
                         "xvadddp 49, 49, 49\n\t"
                         "xvadddp 48, 48, 48\n\t"
                         "xvadddp 47, 47, 47\n\t"
                         "xvadddp 46, 46, 46\n\t"
                         "xvadddp 45, 45, 45\n\t"
                         "xvadddp 44, 44, 44\n\t"
                         "xvadddp 43, 43, 43\n\t"
                         "xvadddp 42, 42, 42\n\t"
                         "xvadddp 41, 41, 41\n\t"
                         "xvadddp 40, 40, 40\n\t"
                         "xvadddp 39, 39, 39\n\t"
                         "xvadddp 38, 38, 38\n\t"
                         "xvadddp 37, 37, 37\n\t"
                         "xvadddp 36, 36, 36\n\t"
                         "xvadddp 35, 35, 35\n\t"
                         "xvadddp 34, 34, 34\n\t"
                         "xvadddp 33, 33, 33\n\t"
                         "xvadddp 32, 32, 32\n\t"
                         "xvadddp 31, 31, 31\n\t"
                         "xvadddp 30, 30, 30\n\t"
                         "xvadddp 29, 29, 29\n\t"
                         "xvadddp 28, 28, 28\n\t"
                         "xvadddp 27, 27, 27\n\t"
                         "xvadddp 26, 26, 26\n\t"
                         "xvadddp 25, 25, 25\n\t"
                         "xvadddp 24, 24, 24\n\t"
                         "xvadddp 23, 23, 23\n\t"
                         "xvadddp 22, 22, 22\n\t"
                         "xvadddp 21, 21, 21\n\t"
                         "xvadddp 20, 20, 20\n\t"
                         "xvadddp 19, 19, 19\n\t"
                         "xvadddp 18, 18, 18\n\t"
                         "xvadddp 17, 17, 17\n\t"
                         "xvadddp 16, 16, 16\n\t"
                         "xvadddp 15, 15, 15\n\t"
                         "xvadddp 14, 14, 14\n\t"
                         "xvadddp 13, 13, 13\n\t"
                         "xvadddp 12, 12, 12\n\t"
                         "xvadddp 11, 11, 11\n\t"
                         "xvadddp 10, 10, 10\n\t"
                         "xvadddp  9,  9,  9\n\t"
                         "xvadddp  8,  8,  8\n\t"
                         "xvadddp  7,  7,  7\n\t"
                         "xvadddp  6,  6,  6\n\t"
                         "xvadddp  5,  5,  5\n\t"
                         "xvadddp  4,  4,  4\n\t"
                         "xvadddp  3,  3,  3\n\t"
                         "xvadddp  2,  2,  2\n\t"
                         "xvadddp  1,  1,  1\n\t"
                         "xvadddp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_double_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}

void gflops_double_madd(double* data) {
    __asm__ __volatile__("lxvd2x 63, 0, %0\n\t"
                         "lxvd2x 62, 0, %0\n\t"
                         "lxvd2x 61, 0, %0\n\t"
                         "lxvd2x 60, 0, %0\n\t"
                         "lxvd2x 59, 0, %0\n\t"
                         "lxvd2x 58, 0, %0\n\t"
                         "lxvd2x 57, 0, %0\n\t"
                         "lxvd2x 56, 0, %0\n\t"
                         "lxvd2x 55, 0, %0\n\t"
                         "lxvd2x 54, 0, %0\n\t"
                         "lxvd2x 53, 0, %0\n\t"
                         "lxvd2x 52, 0, %0\n\t"
                         "lxvd2x 51, 0, %0\n\t"
                         "lxvd2x 50, 0, %0\n\t"
                         "lxvd2x 49, 0, %0\n\t"
                         "lxvd2x 48, 0, %0\n\t"
                         "lxvd2x 47, 0, %0\n\t"
                         "lxvd2x 46, 0, %0\n\t"
                         "lxvd2x 45, 0, %0\n\t"
                         "lxvd2x 44, 0, %0\n\t"
                         "lxvd2x 43, 0, %0\n\t"
                         "lxvd2x 42, 0, %0\n\t"
                         "lxvd2x 41, 0, %0\n\t"
                         "lxvd2x 40, 0, %0\n\t"
                         "lxvd2x 39, 0, %0\n\t"
                         "lxvd2x 38, 0, %0\n\t"
                         "lxvd2x 37, 0, %0\n\t"
                         "lxvd2x 36, 0, %0\n\t"
                         "lxvd2x 35, 0, %0\n\t"
                         "lxvd2x 34, 0, %0\n\t"
                         "lxvd2x 33, 0, %0\n\t"
                         "lxvd2x 32, 0, %0\n\t"
                         "lxvd2x 31, 0, %0\n\t"
                         "lxvd2x 30, 0, %0\n\t"
                         "lxvd2x 29, 0, %0\n\t"
                         "lxvd2x 28, 0, %0\n\t"
                         "lxvd2x 27, 0, %0\n\t"
                         "lxvd2x 26, 0, %0\n\t"
                         "lxvd2x 25, 0, %0\n\t"
                         "lxvd2x 24, 0, %0\n\t"
                         "lxvd2x 23, 0, %0\n\t"
                         "lxvd2x 22, 0, %0\n\t"
                         "lxvd2x 21, 0, %0\n\t"
                         "lxvd2x 20, 0, %0\n\t"
                         "lxvd2x 19, 0, %0\n\t"
                         "lxvd2x 18, 0, %0\n\t"
                         "lxvd2x 17, 0, %0\n\t"
                         "lxvd2x 16, 0, %0\n\t"
                         "lxvd2x 15, 0, %0\n\t"
                         "lxvd2x 14, 0, %0\n\t"
                         "lxvd2x 13, 0, %0\n\t"
                         "lxvd2x 12, 0, %0\n\t"
                         "lxvd2x 11, 0, %0\n\t"
                         "lxvd2x 10, 0, %0\n\t"
                         "lxvd2x  9, 0, %0\n\t"
                         "lxvd2x  8, 0, %0\n\t"
                         "lxvd2x  7, 0, %0\n\t"
                         "lxvd2x  6, 0, %0\n\t"
                         "lxvd2x  5, 0, %0\n\t"
                         "lxvd2x  4, 0, %0\n\t"
                         "lxvd2x  3, 0, %0\n\t"
                         "lxvd2x  2, 0, %0\n\t"
                         "lxvd2x  1, 0, %0\n\t"
                         "lxvd2x  0, 0, %0\n\t"
                         "ld 29, 0(%1)\n\t"
                         "1:\n\t"
                         "xvmuldp 63, 63, 63\n\t"
                         "xvadddp 62, 62, 62\n\t"
                         "xvmuldp 61, 61, 61\n\t"
                         "xvadddp 60, 60, 60\n\t"
                         "xvmuldp 59, 59, 59\n\t"
                         "xvadddp 58, 58, 58\n\t"
                         "xvmuldp 57, 57, 57\n\t"
                         "xvadddp 56, 56, 56\n\t"
                         "xvmuldp 55, 55, 55\n\t"
                         "xvadddp 54, 54, 54\n\t"
                         "xvmuldp 53, 53, 53\n\t"
                         "xvadddp 52, 52, 52\n\t"
                         "xvmuldp 51, 51, 51\n\t"
                         "xvadddp 50, 50, 50\n\t"
                         "xvmuldp 49, 49, 49\n\t"
                         "xvadddp 48, 48, 48\n\t"
                         "xvmuldp 47, 47, 47\n\t"
                         "xvadddp 46, 46, 46\n\t"
                         "xvmuldp 45, 45, 45\n\t"
                         "xvadddp 44, 44, 44\n\t"
                         "xvmuldp 43, 43, 43\n\t"
                         "xvadddp 42, 42, 42\n\t"
                         "xvmuldp 41, 41, 41\n\t"
                         "xvadddp 40, 40, 40\n\t"
                         "xvmuldp 39, 39, 39\n\t"
                         "xvadddp 38, 38, 38\n\t"
                         "xvmuldp 37, 37, 37\n\t"
                         "xvadddp 36, 36, 36\n\t"
                         "xvmuldp 35, 35, 35\n\t"
                         "xvadddp 34, 34, 34\n\t"
                         "xvmuldp 33, 33, 33\n\t"
                         "xvadddp 32, 32, 32\n\t"
                         "xvmuldp 31, 31, 31\n\t"
                         "xvadddp 30, 30, 30\n\t"
                         "xvmuldp 29, 29, 29\n\t"
                         "xvadddp 28, 28, 28\n\t"
                         "xvmuldp 27, 27, 27\n\t"
                         "xvadddp 26, 26, 26\n\t"
                         "xvmuldp 25, 25, 25\n\t"
                         "xvadddp 24, 24, 24\n\t"
                         "xvmuldp 23, 23, 23\n\t"
                         "xvadddp 22, 22, 22\n\t"
                         "xvmuldp 21, 21, 21\n\t"
                         "xvadddp 20, 20, 20\n\t"
                         "xvmuldp 19, 19, 19\n\t"
                         "xvadddp 18, 18, 18\n\t"
                         "xvmuldp 17, 17, 17\n\t"
                         "xvadddp 16, 16, 16\n\t"
                         "xvmuldp 15, 15, 15\n\t"
                         "xvadddp 14, 14, 14\n\t"
                         "xvmuldp 13, 13, 13\n\t"
                         "xvadddp 12, 12, 12\n\t"
                         "xvmuldp 11, 11, 11\n\t"
                         "xvadddp 10, 10, 10\n\t"
                         "xvmuldp  9,  9,  9\n\t"
                         "xvadddp  8,  8,  8\n\t"
                         "xvmuldp  7,  7,  7\n\t"
                         "xvadddp  6,  6,  6\n\t"
                         "xvmuldp  5,  5,  5\n\t"
                         "xvadddp  4,  4,  4\n\t"
                         "xvmuldp  3,  3,  3\n\t"
                         "xvadddp  2,  2,  2\n\t"
                         "xvmuldp  1,  1,  1\n\t"
                         "xvadddp  0,  0,  0\n\t"
                         "subic. 29, 29, 0x1\n\t"
                         "bne 1b\n\t"
                        : : "r"(data), "r"(&g_reps_double_power8) : "vs0","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vs11","vs12","vs13","vs14","vs15","vs16","vs17","vs18","vs19","vs20","vs21","vs22","vs23","vs24","vs25","vs26","vs27","vs28","vs29","vs30","vs31","vs32","vs33","vs34","vs35","vs36","vs37","vs38","vs39","vs40","vs41","vs42","vs43","vs44","vs45","vs46","vs47","vs48","vs49","vs50","vs51","vs52","vs53","vs54","vs55","vs56","vs57","vs58","vs59","vs60","vs61","vs62","vs63","r29","cr0","ca");
}


